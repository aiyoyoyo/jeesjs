this.jeesjs=this.jeesjs||{};(function(){function a(){throw"Application cannot be instantiated."}a._timestamp=0;a._canvas=null;a._contar=null;a._stages=null;a._txtfps=null;a._module=null;a._inited=false;a._showfps=false;a._options={canvasId:"gCanvas",fps:45,width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,queueSize:100};a.init=function(d,c){if(this._inited){return}this._inited=true;jeesjs.MM.init();jeesjs.QM.init({},this._handle_queue_complete);jeesjs.CM.init();if(typeof c==="object"){for(var e in c){if(c.hasOwnProperty(e)){this._options[e]=c[e]}}}this._canvas=document.getElementById(this._options.canvasId);this._canvas.width=this._options.width;this._canvas.height=this._options.height;this._contar=new createjs.Container();this._stages=new createjs.Stage(this._canvas);this._stages.addChild(this._contar);this._txtfps=new createjs.Text();this._txtfps.color="red";this._txtfps.font="bold 24px arial";this._stages.addChild(this._txtfps);createjs.Touch.enable(this._stages);createjs.Ticker.setFPS(this._options.fps);createjs.Ticker.addEventListener("tick",this._handle_ticker);if(d!=undefined){this._module=d}jeesjs.QM.load()};a.update=function(){if(this._showfps){this._txtfps.text=parseInt(createjs.Ticker.getMeasuredFPS())}this._stages.update()};a.showFPS=function(c){this._showfps=c;if(!this._showfps){this._txtfps.text=""}};a.getFPS=function(){return this._options.fps};a.addChild=function(c){this._contar.addChild(c)};a.removeChild=function(c){this._contar.removeChild(c)};a.getTimestamp=function(){return this._timestamp};a.setTimestamp=function(c){this._timestamp=c};a.getSize=function(){return{w:this._canvas.width,h:this._canvas.height}};a.getModule=function(){return this._module};a.setScale=function(d,c){if(d){this._canvas.width=this._canvas.width*d;this._contar.scaleX=d}if(c){this._canvas.height=this._canvas.height*c;this._contar.scaleY=d}};a._handle_queue_complete=function(){if(a.getModule()!=null){jeesjs.MM.enter(a.getModule(),jeesjs.MM.hierarchy())}};a._handle_ticker=function(c){if(!c.paused){var e=createjs.Ticker.getTime(false);var d=e-jeesjs.APP.getTimestamp();jeesjs.APP.setTimestamp(e);jeesjs.MM.update(d)}jeesjs.APP.update()};jeesjs.APP=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"CanvasManager cannot be instantiated."}a._inited=false;a.init=function(){if(this._inited){return}this._inited=true};a.addWidget=function(c){jeesjs.APP.addChild(c.getObject())};a.removeWidget=function(c){jeesjs.APP.removeChild(c.getObject())};a.addChild=function(c){jeesjs.APP.addChild(c)};jeesjs.CM=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"ModulesManager cannot be instantiated."}a._modules=null;a._inited=false;a.init=function(){if(this._inited){return}this._inited=true;this._modules=new Array();this._ident=0};a.enter=function(d,k){var g=k!=undefined?k:0;var c=null;for(var f in this._modules){if(g==f){c=g;break}}if(c==null){this._modules.splice(g,0,new Array())}var j=this._modules[g];if(j===undefined){j=new Array();this._modules.push(j)}if(d.id==-1){d.id=this._ident++}j.push(d);if(g===this.hierarchy()){var e=this._modules[g];if(e.length>1){e[e.length-2].interrupt()}}d.enter()};a.leave=function(e){if(typeof e==="object"){this._leave_module_byid(e.id)}else{if(typeof e==="number"&&e!=this.hierarchy()){this._leave_module_bylv(e)}else{var c=this.hierarchy();var d=this._modules[this.hierarchy()];if(d==undefined){return}d.pop().leave();if(d.length==0){this._modules.pop()}d=this._modules[this.hierarchy()];if(d==undefined){return}d[d.length-1].recovery()}}};a.clear=function(){while(this._modules.length!=0){var c=this._modules[this._modules.length-1];while(c.length!=0){c.pop().leave()}this._modules.pop()}};a.update=function(c){this._modules.forEach(function(d){d.forEach(function(e){e.update(c)})})};a.hierarchy=function(){return this._modules.length>0?this._modules.length-1:0};a._leave_module_byid=function(f){var h=0;var k=0;for(var e=0;e<this._modules.length;e++){var g=this._modules[e];h=e;var l=false;for(var c=0;c<g.length;c++){var d=g[c];if(d.id===f){d.leave();g.splice(c,1);k=c;if(g.length==0){this._modules.pop()}l=true;break}}if(l){break}}if(k==0&&h==this.hierarchy()){var g=this._modules[this.hierarchy()-1];if(g!=undefined){g[g.length-1].recovery()}}};a._leave_module_bylv=function(c){var d=this._modules[c];if(d==undefined){return}d.pop().leave();if(d.length==0){this._modules.splice(c,1)}};jeesjs.MM=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"QueueManager cannot be instantiated."}a._inited=false;a._queue=null;a._progress=0;a._list=[];a._options={size:100};a._handler=function(){};a.init=function(c,e){if(this._inited){return}this._inited=true;if(typeof c==="object"){for(var d in c){if(c.hasOwnProperty(d)){this._options[d]=c[d]}}}this._queue=new createjs.LoadQueue(false,"","Anonymous");this._queue.maintainScriptOrder=true;this._queue.setMaxConnections(this._options.size);if(typeof e==="function"){this._handler=e;this._queue.addEventListener("complete",this._handler)}this._queue.installPlugin(createjs.Sound)};a.getProgress=function(){return this._queue.progress};a.load=function(){if(this._list.length==0){this._handler()}else{this._queue.loadManifest(this._list)}};a.addSource=function(d,c){var e=this._list.length;this._list[e]={id:d,src:c}};a.getSource=function(c){return this._queue.getResult(c)};jeesjs.QM=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){this.id=-1;this.level=0;this.index=0}var c=a.prototype;c.enter=function(){};c.leave=function(){};c.update=function(d){};c.interrupt=function(){};c.recovery=function(){};jeesjs.Module=a})();this.jeesjs=this.jeesjs||{};(function(){function a(d){this._x=0;this._y=0;this._width=0;this._height=0;this._enabled=true;this._checked=false;this._visible=true;this._alpha=1;this._event_map={};this._handle_map={};this._container=null;this._object=null;this._parent=d?d:null}var c=a.prototype;c.getObject=function(){return this._container?this._container:this._object};c.addChild=function(d){if(this.isContainer()){this._container.addChild(d)}else{throw"根节点为非容器类型控件。"}};c.isContainer=function(){return this._container!=null};c.getSize=function(){return{w:this._width,h:this._height}};c.setSize=function(d,e){this._width=d;this._height=e;if(this.isContainer()){this._container.setBounds(this._x,this._y,this._width,this._height)}};c.getPosition=function(){return{x:this._x,y:this._y}};c.setPosition=function(e,d){this._x=e;this._y=d;if(this.isContainer()){this._container.setBounds(this._x,this._y,this._width,this._height)}};c.isEnabled=function(){return this._enabled};c.setEnabled=function(d){this._enabled=d};c.isChecked=function(){return this._checked};c.setChecked=function(d){this._checked=d};c.getAlpha=function(){return this._alpha};c.setAlpha=function(d){this._alpha=d};c.isVisible=function(){return this._visible};c.setVisible=function(d){this._visible=d};c.onEvent=function(d,e){if(typeof e!="function"){throw"参数_f不是有效的方法类型"}if(this._object){this._bind_event(d,this._object,e)}};c.unEvent=function(d){if(this._object){this._unbind_event(d,this._object)}};c._init_finish=function(){if(this._parent!=undefined){this._parent.addChild(this.getObject())}};c._bind_event=function(d,e,g){this._handle_map[d]=g;var f=this;this._event_map[d]=e.addEventListener(d,function(h){f._handle_event(h)})};c._unbind_event=function(d,e){e.removeEventListener(d,this._event_map[d]);this._event_map[d]=null;this._handle_map[d]=null;delete this._event_map[d];delete this._handle_map[d]};c._handle_event=function(d){if(this.isEnabled()){this._handle_map[d.type](d,this)}};jeesjs.Widget=a})();this.jeesjs=this.jeesjs||{};(function(){function a(g,m,k,e){this.Widget_constructor(e);var d=jeesjs.QM.getSource(m);var f=new createjs.Bitmap(d);var j=f.getBounds();var l=g?g:a.TYPE_NORMAL;var i=a.TYPE_CHECK===l;this._width=j.width;this._height=j.height/l;this._btn_text=null;this._checked=false;this._container=new createjs.Container();this._btn_data={images:[d],frames:{width:this._width,height:this._height,count:g},animations:{out:0,over:1,down:2,disable:3,checked_out:i?4:0,checked_over:i?5:1,checked_down:i?6:2,checked_disable:i?7:3}};this._btn_sheet=new createjs.SpriteSheet(this._btn_data);this._object=new createjs.Sprite(this._btn_sheet);this._btn_helper=new createjs.ButtonHelper(this._object);this._btn_text=typeof k==="object"?k:new jeesjs.TextBox(k!=""?k:" ");this._btn_text.setAlign(jeesjs.TextBox.ALIGN_CENTER);this._btn_text.setBaseline(jeesjs.TextBox.BASELINE_MIDDLE);this._btn_text.setPosition(this._width/2,this._height/2);this._container.addChild(this._object);this._container.addChild(this._btn_text.getObject());this.setPosition(0,0);this._init_finish();var h=this;this._object.addEventListener("mousedown",function(n){h._handle_mousedown(n,h)});this._object.addEventListener("pressup",function(n){h._handle_pressup(n,h)})}a.TYPE_NORMAL=4;a.TYPE_CHECK=8;var c=createjs.extend(a,jeesjs.Widget);c.setPosition=function(e,d){this.Widget_setPosition(this._parent?this._parent._x+e:e,this._parent?this._parent._y+d:d);this._object.x=this._x;this._object.y=this._y;this._btn_text.setPosition(this._x+this._width/2,this._y+this._height/2)};c.setEnabled=function(d){if(this.isEnabled()!=d){this._btn_text.setColor(jeesjs.UT.OppositeColor(this._btn_text.getColor()))}this.Widget_setEnabled(d);this._btn_helper.setEnabled(this.isEnabled());this._btn_helper.target.gotoAndPlay(this.isEnabled()?"out":"disable");this._btn_text.setPosition(this._x+this._width/2,this._y+this._height/2)};c.setChecked=function(d){this.Widget_setChecked(d);if(this.isChecked()){this._btn_helper.target.gotoAndPlay(this.isEnabled()?"checked_out":"checked_disable");this._btn_helper.overLabel="checked_over";this._btn_helper.outLabel="checked_out";this._btn_helper.downLabel="checked_down"}else{this._btn_helper.target.gotoAndPlay(this.isEnabled()?"out":"disable");this._btn_helper.overLabel="over";this._btn_helper.outLabel="out";this._btn_helper.downLabel="down"}};c.getText=function(){return this._btn_text.getText()};c.setText=function(d){this._btn_text.setText(d)};c._handle_mousedown=function(d,e){if(!this.isEnabled()){return}var h=e._btn_text.getPosition();var g=e._btn_text.getFontSize()/10;var f=e._btn_text.getObject();f.x=h.x-g;f.y=h.y-g};c._handle_pressup=function(d,e){if(!e.isEnabled()){return}var h=e._btn_text.getPosition();var g=e._btn_text.getFontSize()/10;var f=e._btn_text.getObject();f.x=h.x+g;f.y=h.y+g};jeesjs.Button=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(f,d){this.Widget_constructor(d);this._source=null;this._state=false;this._rect=null;if(typeof f==="string"&&!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(f)||typeof f==="object"){this._source=typeof f==="object"?f:jeesjs.QM.getSource(f);this._object=new createjs.Bitmap(this._source);this._reset_size();this._state=true}else{this._source=f;var e=new Image();e.data=this;e.src=f;e.onload=this._onload_finish;this._object=new createjs.Bitmap(this._source)}this.setPosition(0,0);this._init_finish()}var c=createjs.extend(a,jeesjs.Widget);c.setPosition=function(e,d){this.Widget_setPosition(this._parent?this._parent._x+e:e,this._parent?this._parent._y+d:d);this._object.x=this._x;this._object.y=this._y};c.getState=function(){return this._state};c.getSource=function(){return this._source.src};c.setRect=function(e,d,f,g){this._rect.setValues(e,d,f,g);this._object.sourceRect=this._rect};c.setScale=function(f,e){if(f!=undefined){this._object.scaleX=f}if(e!=undefined){this._object.scaleY=e}var d=this._object.getBounds();this._width=d.width*f;this._height=d.height*e};c.setTile=function(d,e){this._object.tileW=d};c._onload_finish=function(d){this.data._reset_size();this.data._state=true};c._reset_size=function(){var d=this._object.getBounds();this._width=d.width;this._height=d.height;if(this._rect){this._rect.setValues(0,0,this._width,this._height)}else{this._rect=new createjs.Rectangle(0,0,this._width,this._height)}this._object.sourceRect=this.rect};jeesjs.ImageBox=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(f,j,e,d){this.Widget_constructor(d);this._options={type:"normal",begin:0,end:1,row:0,col:0,count:1,rate:30,speed:1,width:0,height:0,regX:0,regY:0,animations:[]};if(typeof e==="object"){for(var g in e){if(e.hasOwnProperty(g)){this._options[g]=e[g]}}}if(!f){this._options.animations={normal:[this._options.begin,this._options.end,this._options.type,this._options.speed]}}var h=jeesjs.QM.getSource(j);this.sourceWidth=h.width;this.sourceHeight=h.height;this._width=this._options.width!=0?this._options.width:this._options.row!=0?this.sourceWidth/this._options.row:b.width;this._height=this._options.height!=0?this._options.height:this._options.row!=0?this.sourceWidth/this._options.row:b.height;this._spt_data={framerate:this._options.rate,images:[h],frames:{width:this._width,height:this._height,count:this._options.count,regX:this._options.regX,regY:this._options.regY},animations:this._options.animations};this._spt_sheet=new createjs.SpriteSheet(this._spt_data);this._object=new createjs.Sprite(this._spt_sheet,this._options.type);this.setPosition(0,0);this._init_finish()}var c=createjs.extend(a,jeesjs.Widget);c.setPosition=function(e,d){this.Widget_setPosition(this._parent?this._parent._x+e:e,this._parent?this._parent._y+d:d);this._object.x=this._x;this._object.y=this._y};c.play=function(d){if(d){this._object.gotoAndPlay(d)}else{this._object.play()}};c.stop=function(d){if(d){this._object.gotoAndStop(d)}else{this._object.stop()}};jeesjs.ImageSpt=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(d){this.Widget_constructor(d);this._width=0;this._height=0;this._bg_color="#000000";this._container=new createjs.Container();this._object=new createjs.Shape();this._container.addChild(this._object);this._container.mask=this._object;this._init_finish();this.setSize(200,200);this.setPosition(0,0)}var c=createjs.extend(a,jeesjs.Widget);c.setSize=function(d,e){this.Widget_setSize(d,e);this._reset_bg()};c.setPosition=function(e,d){this.Widget_setPosition(e,d);this._object.x=e;this._object.y=d;this._reset_bg()};c.getColor=function(){return this._bg_color};c.setColor=function(d){this._bg_color=d;this._reset_bg()};c.setTile=function(n,k,h,g,i,e){var d=k?k:0;var l=h?h:0;var j=g?g:0;var m=i?i:this._width;var f=e?e:this._height;if(typeof n==="string"){this._object.graphics.beginBitmapFill(jeesjs.QM.getSource(n)).drawRect(l,j,m,f)}};c._reset_bg=function(){var e=this.getPosition();var d=this.getSize();this._object.graphics.clear().beginFill(this._bg_color).drawRect(0,0,d.w,d.h)};jeesjs.Panel=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(e,d){this.Widget_constructor(d);this._font_bold="";this._font_italic="";this._font_size=12;this._font_style=" Arial";this._text=e?e:"";this._color="#ffffff";this._font=this._get_font();this._object=new createjs.Text(this._text,this._font,this._color);this._object._drawText=this._draw_text;this._object.lineHeight=this._font_size;this.setPosition(0,0);this._init_finish()}a.ALIGN_START="start";a.ALIGN_END="end";a.ALIGN_LEFT="left";a.ALIGN_RIGHT="right";a.ALIGN_CENTER="center";a.BASELINE_TOP="top";a.BASELINE_HANGING="hanging";a.BASELINE_MIDDLE="middle";a.BASELINE_ALPHABETIC="alphabetic";a.BASELINE_IDEOGRAPHIC="ideographic";a.BASELINE_BOTTOM="bottom";var c=createjs.extend(a,jeesjs.Widget);c.setPosition=function(e,d){this.Widget_setPosition(this._parent?this._parent._x+e:e,this._parent?this._parent._y+d:d);this._object.x=this._x;this._object.y=this._y};c.getColor=function(){return this._color};c.setColor=function(d){this._color=d;this._object.color=d};c.setFont=function(d){this._font=d;this._object.font=d};c.getFontStyle=function(){return this._font_style};c.setFontStyle=function(d){this._font_style=d;this._object.font=this._get_font()};c.getFontSize=function(){return this._font_size};c.setFontSize=function(d){this._font_size=d;this._object.lineHeight=this._font_size;this._object.font=this._get_font()};c.getAlign=function(){return this._object.textAlign};c.setAlign=function(d){this._object.textAlign=d};c.getBaseline=function(){return this._object.textBaseline};c.setBaseline=function(d){this._object.textBaseline=d};c.getMaxWidth=function(){return this._object.maxWidth};c.setMaxWidth=function(d){this._object.maxWidth=d};c.getLineWidth=function(){return this._object.lineWidth};c.setLineWidth=function(d){this._object.lineWidth=d};c.getText=function(){return this._text};c.setText=function(d){this._text=d;this._object.text=d};c.isBold=function(){return this._font_bold!=""};c.setBold=function(d){this._font_bold=d?" bold":"";this._text.font=this._get_font()};c.isItalic=function(){return this._font_bold!=""};c.setItalic=function(d){this._font_italic=d?" italic":"";this._text.font=this._get_font()};c._get_font=function(){this._font=this._font_italic+this._font_bold+" "+this._font_size+"px "+this._font_style;return this._font};c._draw_text=function(v,s,e){var r=!!v;if(!r){v=createjs.Text._workingContext;v.save();this._prepContext(v)}var g=this.lineHeight||this.getMeasuredLineHeight();var B=0,k=0;var f=String(this.text).split(/(?:\r\n|\r|\n)/);for(var z=0,x=f.length;z<x;z++){var t=f[z];var m=null;if(this.lineWidth!=null&&(m=v.measureText(t).width)>this.lineWidth){var q=t.split(/(\s|[\u4e00-\u9fa5]+)/);var u=[];for(var p=0;p<q.length;p++){var n=q[p];if(n==""){continue}if((/([\u4e00-\u9fa5]+)/).test(n)){u=u.concat(n.split(""))}else{u.push(n)}}q=u;t=q[0];m=v.measureText(t).width;for(var y=1,A=q.length;y<A;y+=2){var d=y+1<A?q[y+1]:"";var h=v.measureText(q[y]+d).width;if(m+h>this.lineWidth){if(q[y]!="s"){t+=q[y]}if(r){this._drawTextLine(v,t,k*g)}if(e){e.push(t)}if(m>B){B=m}t=d;m=v.measureText(t).width;k++}else{t+=q[y]+d;m+=h}}}if(r){this._drawTextLine(v,t,k*g)}if(e){e.push(t)}if(s&&m==null){m=v.measureText(t).width}if(m>B){B=m}k++}if(s){s.width=B;s.height=k*g}if(!r){v.restore()}return s};jeesjs.TextBox=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"UtilTools cannot be instantiated."}a.Random=(function(){var c=new Date().getTime();function d(){c=(c*9301+49297)%233280;return c/233280}return function(e,f){return Math.ceil(d()*e)+(f?f:0)}})();a.RandomColor=(function(){function c(){var d=jeesjs.UT.Random(256);if(d<10){return"0"+d}return d.toString(16)}return function(){return"#"+c()+c()+c()}})();a.OppositeColor=(function(){function c(e){var h=parseInt(e.substring(1,3),16);var g=parseInt(e.substring(3,5),16);var f=parseInt(e.substring(5),16);return{r:h,g:g,b:f}}function d(e){var f=255-e;if(f>64&&f<128){f-=64}else{if(f>=128&&f<192){f+=64}}if(f<10){return"0"+f}return f.toString(16)}return function(f){var h=c(f);var j=d(h.r);var i=d(h.g);var e=d(h.b);return"#"+j+i+e}})();jeesjs.UT=a})();