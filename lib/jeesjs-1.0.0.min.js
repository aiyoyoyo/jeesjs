this.jeesjs=this.jeesjs||{};(function(){function a(){throw"Application cannot be instantiated."}a._timestamp=0;a._canvas=null;a._contar=null;a._stages=null;a._txtfps=null;a._module=null;a._inited=false;a._showfps=false;a._options={canvasId:"gCanvas",fps:45,width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,queueSize:100};a.init=function(c,b){if(this._inited){return}this._inited=true;jeesjs.MM.init();jeesjs.QM.init({},this._handle_queue_complete);jeesjs.CM.init();if(typeof b==="object"){for(var d in b){if(b.hasOwnProperty(d)){this._options[d]=b[d]}}}this._canvas=document.getElementById(this._options.canvasId);this._canvas.width=this._options.width;this._canvas.height=this._options.height;this._contar=new createjs.Container();this._stages=new createjs.Stage(this._canvas);this._stages.addChild(this._contar);this._txtfps=new createjs.Text();this._txtfps.color="red";this._txtfps.font="bold 24px arial";this._stages.addChild(this._txtfps);createjs.Touch.enable(this._stages);createjs.Ticker.setFPS(this._options.fps);createjs.Ticker.addEventListener("tick",this._handle_ticker);if(c!=undefined){this._module=c}jeesjs.QM.load()};a.update=function(){if(this._showfps){this._txtfps.text=parseInt(createjs.Ticker.getMeasuredFPS())}this._stages.update()};a.showFPS=function(b){this._showfps=b;if(!this._showfps){this._txtfps.text=""}};a.getFPS=function(){return this._options.fps};a.addChild=function(b){this._contar.addChild(b)};a.getTimestamp=function(){return this._timestamp};a.setTimestamp=function(b){this._timestamp=b};a.getSize=function(){return{w:this._canvas.width,h:this._canvas.height}};a.getModule=function(){return this._module};a.setScale=function(c,b){if(c){this._canvas.width=this._canvas.width*c;this._contar.scaleX=c}if(b){this._canvas.height=this._canvas.height*b;this._contar.scaleY=c}};a._handle_queue_complete=function(){if(a.getModule()!=null){jeesjs.MM.enter(a.getModule(),jeesjs.MM.hierarchy())}};a._handle_ticker=function(b){if(!b.paused){var d=createjs.Ticker.getTime(false);var c=d-jeesjs.APP.getTimestamp();jeesjs.APP.setTimestamp(d);jeesjs.MM.update(c)}jeesjs.APP.update()};jeesjs.APP=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"CanvasManager cannot be instantiated."}a._inited=false;a.init=function(){if(this._inited){return}this._inited=true};a.addWidget=function(b){jeesjs.APP.addChild(b.getObject())};a.addChild=function(b){jeesjs.APP.addChild(b)};jeesjs.CM=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"ModulesManager cannot be instantiated."}a._modules=null;a._inited=false;a.init=function(){if(this._inited){return}this._inited=true;this._modules=new Array()};a.enter=function(b,f){var c=this.hierarchy();if(f!=undefined){c=f}var d=this._modules[c];if(d===undefined){d=new Array();if(c>0){var e=this._modules[c-1];if(e.length!=0){e[e.length-1].interrupt()}}this._modules.push(d)}if(d.length!=0){d[d.length-1].interrupt()}d.push(b);b.enter()};a.leave=function(){var b=this._modules.length;if(b==0){return}var c=this._modules[b-1];b=c.length;if(b==0){return}if(b>1){c.pop().leave();c[c.length-1].recovery()}else{c=this._modules.pop();c.pop().leave();if(this._modules.length>0){c=this._modules[this._modules.length-1];c[c.length-1].recovery()}}};a.clear=function(){while(this._modules.length!=0){var b=this._modules[this._modules.length-1];while(b.length!=0){b.pop().leave()}this._modules.pop()}};a.update=function(b){this._modules.forEach(function(c){c.forEach(function(d){d.update(b)})})};a.hierarchy=function(){return this._modules.length>0?this._modules.length-1:0};jeesjs.MM=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"QueueManager cannot be instantiated."}a._inited=false;a._queue=null;a._progress=0;a._list=[];a._options={size:100};a._handler=function(){};a.init=function(b,d){if(this._inited){return}this._inited=true;if(typeof b==="object"){for(var c in b){if(b.hasOwnProperty(c)){this._options[c]=b[c]}}}this._queue=new createjs.LoadQueue(false,"","Anonymous");this._queue.maintainScriptOrder=true;this._queue.setMaxConnections(this._options.size);if(typeof d==="function"){this._handler=d;this._queue.addEventListener("complete",this._handler)}this._queue.installPlugin(createjs.Sound)};a.getProgress=function(){return this._queue.progress};a.load=function(){if(this._list.length==0){this._handler()}else{this._queue.loadManifest(this._list)}};a.addSource=function(c,b){var d=this._list.length;this._list[d]={id:c,src:b}};a.getSource=function(b){return this._queue.getResult(b)};jeesjs.QM=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){}var b=a.prototype;b.enter=function(){};b.leave=function(){};b.update=function(c){};b.interrupt=function(){};b.recovery=function(){};jeesjs.Module=a})();this.jeesjs=this.jeesjs||{};(function(){function a(c){this._width=0;this._height=0;this._enable=true;this._event_map={};this._handle_map={};this._container=null;this._object=null;this._parent=c?c:null}var b=a.prototype;b.getObject=function(){return this._container?this._container:this._object};b.addObject=function(c){if(this.isContainer()){this.getObject().addChild(c)}else{throw"根节点为非容器类型控件。"}};b.isContainer=function(){return this._container!=null};b.getSize=function(){return{w:this._width,h:this._height}};b.setSize=function(c,e){this._width=c;this._height=e;var d=this.getObject();d.w=c;d.h=e};b.getPosition=function(){var c=this.getObject();return{x:c.x,y:c.y}};b.setPosition=function(d,c){var e=this.getObject();e.x=d;e.y=c};b.isEnabled=function(){return this._enable};b.setEnabled=function(c){this._enable=c};b.getAlpha=function(){return this.getObject().alpha};b.setAlpha=function(c){this.getObject().alpha=c};b.isVisible=function(){return this.getObject().visible};b.setVisible=function(c){this.getObject().visible=c};b.onEvent=function(c,d){if(typeof d!="function"){throw"参数_f不是有效的方法类型"}if(this._object){this._bind_event(c,this._object,d)}};b.unEvent=function(c){if(this._object){this._unbind_event(c,this._object)}};b._init_finish=function(){if(this._parent!=undefined){this._parent.addObject(this.getObject())}};b._bind_event=function(c,d,f){this._handle_map[c]=f;var e=this;this._event_map[c]=d.addEventListener(c,function(g){e._handle_event(g)})};b._unbind_event=function(c,d){d.removeEventListener(c,this._event_map[c]);this._event_map[c]=null;this._handle_map[c]=null;delete this._event_map[c];delete this._handle_map[c]};b._handle_event=function(c){if(this.isEnabled()){this._handle_map[c.type](c,this)}};jeesjs.Widget=a})();this.jeesjs=this.jeesjs||{};(function(){function a(g,m,k,e){this.Widget_constructor(e);var d=jeesjs.QM.getSource(m);var f=new createjs.Bitmap(d);var j=f.getBounds();var l=g?g:a.TYPE_NORMAL;var i=a.TYPE_CHECK===l;this._width=j.width;this._height=j.height/l;this._btn_text=null;this._checked=false;this._container=new createjs.Container();this._btn_data={images:[d],frames:{width:this._width,height:this._height,count:g},animations:{out:0,over:1,down:2,disable:3,checked_out:i?4:0,checked_over:i?5:1,checked_down:i?6:2,checked_disable:i?7:3}};this._btn_sheet=new createjs.SpriteSheet(this._btn_data);this._object=new createjs.Sprite(this._btn_sheet);this._btn_helper=new createjs.ButtonHelper(this._object);this._btn_text=typeof k==="object"?k:new jeesjs.TextBox(k!=""?k:" ");this._btn_text.setAlign(jeesjs.TextBox.ALIGN_CENTER);this._btn_text.setBaseline(jeesjs.TextBox.BASELINE_MIDDLE);this._btn_text.setPosition(this._width/2,this._height/2);this._container.addChild(this._object);this._container.addChild(this._btn_text.getObject());this._init_finish();var h=this;this._object.addEventListener("mousedown",function(c){h._handle_mousedown(c,h)});this._object.addEventListener("pressup",function(c){h._handle_pressup(c,h)})}a.TYPE_NORMAL=4;a.TYPE_CHECK=8;var b=createjs.extend(a,jeesjs.Widget);b.setPosition=function(d,c){this.Widget_setPosition(d,c)};b.setEnabled=function(c){this.Widget_setEnabled(c);this._btn_helper.setEnabled(this.isEnabled());this._btn_helper.target.gotoAndPlay(this.isEnabled()?"out":"disable")};b.isChecked=function(){return this._checked};b.setChecked=function(c){this._checked=c;if(this.isChecked()){this._btn_helper.target.gotoAndPlay(this.isEnabled()?"checked_out":"checked_disable");this._btn_helper.overLabel="checked_over";this._btn_helper.outLabel="checked_out";this._btn_helper.downLabel="checked_down"}else{this._btn_helper.target.gotoAndPlay(this.isEnabled()?"out":"disable");this._btn_helper.overLabel="over";this._btn_helper.outLabel="out";this._btn_helper.downLabel="down"}};b.getText=function(){return this._btn_text.getText()};b.setText=function(c){this._btn_text.setText(c)};b._handle_mousedown=function(c,d){if(!this.isEnabled()){return}var f=d._btn_text.getPosition();var e=d._btn_text.getFontSize()/10;d._btn_text.setPosition(f.x-e,f.y-e)};b._handle_pressup=function(c,d){if(!d.isEnabled()){return}var f=d._btn_text.getPosition();var e=d._btn_text.getFontSize()/10;d._btn_text.setPosition(f.x+e,f.y+e)};jeesjs.Button=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(e,c){this.Widget_constructor(c);this._source=null;this._state=false;this._rect=null;if(typeof e==="string"&&!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(e)||typeof e==="object"){this._source=typeof e==="object"?e:jeesjs.QM.getSource(e);this._object=new createjs.Bitmap(this._source);this._reset_size();this._state=true}else{this._source=e;var d=new Image();d.data=this;d.src=e;d.onload=this._onload_finish;this._object=new createjs.Bitmap(this._source)}this._init_finish()}var b=createjs.extend(a,jeesjs.Widget);b.getState=function(){return this._state};b.getSource=function(){return this._source.src};b.setRect=function(d,c,e,f){this._rect.setValues(d,c,e,f);this._object.sourceRect=this._rect};b.setScale=function(e,d){if(e!=undefined){this._object.scaleX=e}if(d!=undefined){this._object.scaleY=d}var c=this._object.getBounds();this._width=c.width*e;this._height=c.height*d};b.setTile=function(c,d){this._object.tileW=c};b._onload_finish=function(c){this.data._reset_size();this.data._state=true};b._reset_size=function(){var c=this._object.getBounds();this._width=c.width;this._height=c.height;if(this._rect){this._rect.setValues(0,0,this._width,this._height)}else{this._rect=new createjs.Rectangle(0,0,this._width,this._height)}this._object.sourceRect=this.rect};jeesjs.ImageBox=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(f,k,e,d){this.Widget_constructor(d);this._options={type:"normal",begin:0,end:1,row:0,col:0,count:1,rate:30,speed:1,width:0,height:0,regX:0,regY:0,animations:[]};if(typeof e==="object"){for(var h in e){if(e.hasOwnProperty(h)){this._options[h]=e[h]}}}if(!f){this._options.animations={normal:[this._options.begin,this._options.end,this._options.type,this._options.speed]}}var j=jeesjs.QM.getSource(k);var g=new createjs.Bitmap(j);var c=g.getBounds();this.sourceWidth=c.width;this.sourceHeight=c.height;this.w=this._options.width!=0?this._options.width:this._options.row!=0?this.sourceWidth/this._options.row:c.width;this.h=this._options.height!=0?this._options.height:this._options.row!=0?this.sourceWidth/this._options.row:c.height;this._spt_data={framerate:this._options.rate,images:[j],frames:{width:this.w,height:this.h,count:this._options.count,regX:this._options.regX,regY:this._options.regY},animations:this._options.animations};this._spt_sheet=new createjs.SpriteSheet(this._spt_data);this._object=new createjs.Sprite(this._spt_sheet,this._options.type);this._init_finish()}var b=createjs.extend(a,jeesjs.Widget);b.play=function(c){if(c){this._object.gotoAndPlay(c)}else{this._object.play()}};b.stop=function(c){if(c){this._object.gotoAndStop(c)}else{this._object.stop()}};jeesjs.ImageSpt=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(c){this.Widget_constructor(c);this._width=200;this._height=200;this._bg_color="#000000";this._container=new createjs.Container();this._object=new createjs.Shape();this._container.addChild(this._object);this._container.mask=this._object;this._init_finish();this._reset_bg()}var b=createjs.extend(a,jeesjs.Widget);b.setSize=function(c,d){this.Widget_setSize(c,d);this._reset_bg()};b.setPosition=function(d,c){this.Widget_setPosition(d,c);this._object.x=d;this._object.y=c;this._reset_bg()};b.getColor=function(){return this._bg_color};b.setColor=function(c){this._bg_color=c;this._reset_bg()};b.setTile=function(m,j,g,f,h,d){var c=j?j:0;var k=g?g:0;var i=f?f:0;var l=h?h:this._width;var e=d?d:this._height;if(typeof m==="string"){this._object.graphics.beginBitmapFill(jeesjs.QM.getSource(m)).drawRect(k,i,l,e)}};b._reset_bg=function(){var d=this.getPosition();var c=this.getSize();this._object.graphics.clear().beginFill(this._bg_color).drawRect(d.x,d.y,c.w,c.h)};jeesjs.Panel=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(d,c){this.Widget_constructor(c);this._font_bold="";this._font_italic="";this._font_size=12;this._font_style=" Arial";this._text=d?d:"";this._color="#ffffff";this._font=this._get_font();this._object=new createjs.Text(this._text,this._font,this._color);this._object._drawText=this._draw_text;this._object.lineHeight=this._font_size;this._init_finish()}a.ALIGN_START="start";a.ALIGN_END="end";a.ALIGN_LEFT="left";a.ALIGN_RIGHT="right";a.ALIGN_CENTER="center";a.BASELINE_TOP="top";a.BASELINE_HANGING="hanging";a.BASELINE_MIDDLE="middle";a.BASELINE_ALPHABETIC="alphabetic";a.BASELINE_IDEOGRAPHIC="ideographic";a.BASELINE_BOTTOM="bottom";var b=createjs.extend(a,jeesjs.Widget);b.getColor=function(){return this._color};b.setColor=function(c){this._color=c;this._object.color=c};b.setFont=function(c){this._font=c;this._object.font=c};b.getFontStyle=function(){return this._font_style};b.setFontStyle=function(c){this._font_style=c;this._object.font=this._get_font()};b.getFontSize=function(){return this._font_size};b.setFontSize=function(c){this._font_size=c;this._object.lineHeight=this._font_size;console.log(this._get_font());this._object.font=this._get_font()};b.getAlign=function(){return this._object.textAlign};b.setAlign=function(c){this._object.textAlign=c};b.getBaseline=function(){return this._object.textBaseline};b.setBaseline=function(c){this._object.textBaseline=c};b.getMaxWidth=function(){return this._object.maxWidth};b.setMaxWidth=function(c){this._object.maxWidth=c};b.getLineWidth=function(){return this._object.lineWidth};b.setLineWidth=function(c){this._object.lineWidth=c};b.getText=function(){return this._text};b.setText=function(c){this._text=c;this._object.text=c};b.isBold=function(){return this._font_bold!=""};b.setBold=function(c){this._font_bold=c?" bold":"";this._text.font=this._get_font()};b.isItalic=function(){return this._font_bold!=""};b.setItalic=function(c){this._font_italic=c?" italic":"";this._text.font=this._get_font()};b._get_font=function(){this._font=this._font_italic+this._font_bold+" "+this._font_size+"px "+this._font_style;return this._font};b._draw_text=function(u,r,d){var q=!!u;if(!q){u=createjs.Text._workingContext;u.save();this._prepContext(u)}var f=this.lineHeight||this.getMeasuredLineHeight();var A=0,h=0;var e=String(this.text).split(/(?:\r\n|\r|\n)/);for(var y=0,v=e.length;y<v;y++){var s=e[y];var k=null;if(this.lineWidth!=null&&(k=u.measureText(s).width)>this.lineWidth){var p=s.split(/(\s|[\u4e00-\u9fa5]+)/);var t=[];for(var n=0;n<p.length;n++){var m=p[n];if(m==""){continue}if((/([\u4e00-\u9fa5]+)/).test(m)){t=t.concat(m.split(""))}else{t.push(m)}}p=t;s=p[0];k=u.measureText(s).width;for(var x=1,z=p.length;x<z;x+=2){var c=x+1<z?p[x+1]:"";var g=u.measureText(p[x]+c).width;if(k+g>this.lineWidth){if(p[x]!="s"){s+=p[x]}if(q){this._drawTextLine(u,s,h*f)}if(d){d.push(s)}if(k>A){A=k}s=c;k=u.measureText(s).width;h++}else{s+=p[x]+c;k+=g}}}if(q){this._drawTextLine(u,s,h*f)}if(d){d.push(s)}if(r&&k==null){k=u.measureText(s).width}if(k>A){A=k}h++}if(r){r.width=A;r.height=h*f}if(!q){u.restore()}return r};jeesjs.TextBox=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"UtilTools cannot be instantiated."}a.Random=(function(){var b=new Date().getTime();function c(){b=(b*9301+49297)%233280;return b/233280}return function(d,e){return Math.ceil(c()*d)+(e?e:0)}})();a.RandomColor=function(){var e=this.Random(256).toString(16);var d=this.Random(256).toString(16);var c=this.Random(256).toString(16);return"#"+e+d+c};jeesjs.UT=a})();