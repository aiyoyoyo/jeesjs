this.jeesjs=this.jeesjs||{};(function(){function a(){throw"Application cannot be instantiated."}a._time=0;a._canvas=null;a._contar=null;a._stages=null;a._txtfps=null;a._module=null;a._inited=false;a._showfps=false;a._options={canvasId:"gCanvas",fps:45,width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,queueSize:100};a.init=function(c,b){if(this._inited){return}this._inited=true;jeesjs.MM.init();jeesjs.QM.init({},this._handle_queue_complete);jeesjs.CM.init();if(typeof b==="object"){for(var d in b){if(b.hasOwnProperty(d)){this._options[d]=b[d]}}}this._canvas=document.getElementById(this._options.canvasId);this._canvas.width=this._options.width;this._canvas.height=this._options.height;this._contar=new createjs.Container();this._stages=new createjs.Stage(this._canvas);this._stages.addChild(this._contar);this._txtfps=new createjs.Text();this._txtfps.color="red";this._txtfps.font="bold 24px arial";this._stages.addChild(this._txtfps);createjs.Touch.enable(this._stages);createjs.Ticker.setFPS(this._options.fps);createjs.Ticker.addEventListener("tick",this._handle_ticker);if(c!=undefined){this._module=c}jeesjs.QM.load()};a.showFPS=function(b){this._showfps=b;if(!this._showfps){this._txtfps.text=""}};a.getSize=function(){return{w:this._canvas.width,h:this._canvas.height}};a.setScale=function(c,b){if(c){this._canvas.width=this._canvas.width*c;this._contar.scaleX=c}if(b){this._canvas.height=this._canvas.height*b;this._contar.scaleY=c}};a.Random=(function(){var b=new Date().getTime();function c(){b=(b*9301+49297)%233280;return b/233280}return function(d){return Math.ceil(c()*d)}})();a.RandomColor=function(){var e=this.Random(256).toString(16);var d=this.Random(256).toString(16);var c=this.Random(256).toString(16);return"#"+e+d+c};a._handle_queue_complete=function(){if(jeesjs.APP._module!=null){jeesjs.MM.enter(jeesjs.APP._module,jeesjs.MM.hierarchy())}};a._handle_ticker=function(b){if(jeesjs.APP._showfps){jeesjs.APP._txtfps.text=parseInt(createjs.Ticker.getMeasuredFPS())}jeesjs.APP._stages.update();if(!b.paused){var d=createjs.Ticker.getTime(false);var c=d-jeesjs.APP._time;jeesjs.APP._time=d;jeesjs.MM.update(c)}};jeesjs.APP=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){}var b=a.prototype;b.enter=function(){};b.leave=function(){};b.update=function(c){};b.interrupt=function(){};b.recovery=function(){};jeesjs.Module=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"CanvasManager cannot be instantiated."}a._inited=false;a.init=function(){if(this._inited){return}this._inited=true};a.addWidget=function(b){jeesjs.APP._contar.addChild(b.getWidget())};a.addChild=function(b){jeesjs.APP._contar.addChild(b)};jeesjs.CM=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"ModulesManager cannot be instantiated."}a._modules=null;a._inited=false;a.init=function(){if(this._inited){return}this._inited=true;this._modules=new Array()};a.enter=function(b,f){var c=this.hierarchy();if(f!=undefined){c=f}var d=this._modules[c];if(d===undefined){d=new Array();if(c>0){var e=this._modules[c-1];if(e.length!=0){e[e.length-1].interrupt()}}this._modules.push(d)}if(d.length!=0){d[d.length-1].interrupt()}d.push(b);b.enter()};a.leave=function(){var b=this._modules.length;if(b==0){return}var c=this._modules[b-1];b=c.length;if(b==0){return}if(b>1){c.pop().leave();c[c.length-1].recovery()}else{c=this._modules.pop();c.pop().leave();if(this._modules.length>0){c=this._modules[this._modules.length-1];c[c.length-1].recovery()}}};a.clear=function(){while(this._modules.length!=0){var b=this._modules[this._modules.length-1];while(b.length!=0){b.pop().leave()}this._modules.pop()}};a.update=function(b){this._modules.forEach(function(c){c.forEach(function(d){d.update(b)})})};a.hierarchy=function(){return this._modules.length>0?this._modules.length-1:0};jeesjs.MM=a})();this.jeesjs=this.jeesjs||{};(function(){function a(){throw"QueueManager cannot be instantiated."}a._inited=false;a._queue=null;a._progress=0;a._list=[];a._options={size:100};a._handler=function(){};a.init=function(b,d){if(this._inited){return}this._inited=true;if(typeof b==="object"){for(var c in b){if(b.hasOwnProperty(c)){this._options[c]=b[c]}}}this._queue=new createjs.LoadQueue(true);this._queue.maintainScriptOrder=true;this._queue.setMaxConnections(this._options.size);if(typeof d==="function"){this._handler=d;this._queue.addEventListener("complete",this._handler)}this._queue.installPlugin(createjs.Sound)};a.getProgress=function(){return this._queue.progress};a.load=function(){if(this._list.length==0){this._handler()}else{this._queue.loadManifest(this._list)}};a.addSource=function(c,b){var d=this._list.length;this._list[d]={id:c,src:b}};a.getSource=function(b){return this._queue.getResult(b)};jeesjs.QM=a})();this.jeesjs=this.jeesjs||{};(function(){function a(c){this.x=0;this.y=0;this.w=0;this.h=0;this.e=true;this._event_map={};this._handle_map={};this._container=null;this._parent=c?c:null}var b=a.prototype;b.getWidget=function(){return this._container};b.addChild=function(c){if(this.isContainer()){this.getWidget().addChild(c)}else{throw"根节点为非容器类型控件。"}};b.isContainer=function(){return this._container!=null};b.getSize=function(){return{w:this.w,h:this.h}};b.setSize=function(c,d){this.w=c;this.h=d;if(this.isContainer()){this.getWidget().setBounds(this.x,this.y,this.w,this.h)}else{this.getWidget().w=this.w;this.getWidget().h=this.h}};b.getPosition=function(){return{x:this.x,y:this.y}};b.setPosition=function(d,c){this.x=this._parent?this._parent.x+d:d;this.y=this._parent?this._parent.y+c:c;if(this.isContainer()){this.getWidget().setBounds(this.x,this.y,this.w,this.h)}else{this.getWidget().x=this.x;this.getWidget().y=this.y}};b.isEnabled=function(){return this.e};b.getAbsPosition=function(){return{x:this.getWidget().regX,y:this.getWidget().regY}};b.setEnabled=function(c){this.e=c};b.onEvent=function(c,d){this._bind_event(c,this.getWidget(),d)};b.unEvent=function(c){this._unbind_event(c,this.getWidget())};b._init_finish=function(){if(this._parent!=undefined){this._parent.addChild(this.getWidget())}};b._bind_event=function(c,d,f){this._handle_map[c]=f;var e=this;this._event_map[c]=d.addEventListener(c,function(g){e._handle_event(g)})};b._unbind_event=function(c,d){d.removeEventListener(c,this._event_map[c]);this._event_map[c]=null;this._handle_map[c]=null;delete this._event_map[c];delete this._handle_map[c]};b._handle_event=function(c){if(this.isEnabled()){this._handle_map[c.type](c,this)}};jeesjs.Widget=a})();this.jeesjs=this.jeesjs||{};(function(){function a(i,j,h,e){this.Widget_constructor(e);var g=jeesjs.QM.getSource(j);var f=new createjs.Bitmap(g);var d=f.getBounds();this.w=d.width;this.h=d.height/i;this._btn_text=null;this._c=false;this._container=new createjs.Container();var c=a.TYPE_CHECK===i;this._btn_data={images:[g],frames:{width:this.w,height:this.h,count:i},animations:{out:0,over:1,down:2,disable:3,checked_out:c?4:0,checked_over:c?5:1,checked_down:c?6:2,checked_disable:c?7:3}};this._btn_sheet=new createjs.SpriteSheet(this._btn_data);this._btn_sprite=new createjs.Sprite(this._btn_sheet);this._btn_helper=new createjs.ButtonHelper(this._btn_sprite);if(typeof h==="string"){this._btn_text=new jeesjs.TextBox(h)}else{if(typeof h==="object"){this._btn_text=h}}this._btn_text.setAlign(jeesjs.TextBox.ALIGN_CENTER);this._btn_text.setBaseline(jeesjs.TextBox.BASELINE_MIDDLE);this._btn_text.setPosition(this.w/2,this.h/2);this._container.addChild(this._btn_sprite);this._container.addChild(this._btn_text.getWidget());this._init_finish();this.onEvent("mousedown",this._handle_mousedown);this.onEvent("pressup",this._handle_pressup)}a.TYPE_NORMAL=4;a.TYPE_CHECK=8;var b=createjs.extend(a,jeesjs.Widget);b.onEvent=function(c,d){if(typeof d!="function"){throw"参数_f不是有效的方法类型"}this._bind_event(c,this._btn_sprite,d)};b.unEvent=function(c){this._unbind_event(c,this._btn_sprite)};b.setPosition=function(d,c){this.Widget_setPosition(d,c);this.getWidget().x=this.x;this.getWidget().y=this.y};b.setEnabled=function(c){this.Widget_setEnabled(c);this._btn_helper.setEnabled(this.isEnabled());this._btn_helper.target.gotoAndPlay(this.isEnabled()?"out":"disable")};b.isChecked=function(){return this._c};b.setChecked=function(c){this._c=c;if(this.isChecked()){this._btn_helper.target.gotoAndPlay(this.isEnabled()?"checked_out":"checked_disable");this._btn_helper.overLabel="checked_over";this._btn_helper.outLabel="checked_out";this._btn_helper.downLabel="checked_down"}else{this._btn_helper.target.gotoAndPlay(this.isEnabled()?"out":"disable");this._btn_helper.overLabel="over";this._btn_helper.outLabel="out";this._btn_helper.downLabel="down"}};b.getText=function(){return this._btn_text.getText()};b.setText=function(c){this._btn_text.setText(c)};b._handle_mousedown=function(c,d){if(!d.isEnabled()){return}var f=d._btn_text.getPosition();var e=d._btn_text.getFontSize()/10;d._btn_text.setPosition(f.x-e,f.y-e)};b._handle_pressup=function(c,d){if(!d.isEnabled()){return}var f=d._btn_text.getPosition();var e=d._btn_text.getFontSize()/10;d._btn_text.setPosition(f.x+e,f.y+e)};jeesjs.Button=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(f,d){this.Widget_constructor(d);this.r=null;this._state=false;this._image=null;if(typeof f==="string"&&!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(f)||typeof f==="object"){this.r=typeof f==="object"?f:jeesjs.QM.getSource(f);this._image=new createjs.Bitmap(this.r);var c=this._image.getBounds();this.w=c.width;this.h=c.height;this._state=true;this._init_finish()}else{this.r=f;var e=new Image();e.data=this;e.src=f;e.onload=this._handle_finish;this._image=new createjs.Bitmap(this.r);this._init_finish()}}var b=createjs.extend(a,jeesjs.Widget);b.getWidget=function(){return this._image};b.getState=function(){return this._state};b._handle_finish=function(c){this.data._reset_size();this.data._state=true};b._reset_size=function(){var c=this._image.getBounds();this.w=c.width;this.h=c.height};jeesjs.ImageBox=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(c){this.Widget_constructor(c);this.c="#000000";this.w=100;this.h=100;this._container=new createjs.Container();this._shape=new createjs.Shape();this._shape.graphics.beginFill(this.c).drawRect(this.x,this.y,this.w,this.h);this._container.addChild(this._shape);this._container.mask=this._shape;this._init_finish()}var b=createjs.extend(a,jeesjs.Widget);b.onEvent=function(c,d){if(typeof d!="function"){throw"参数_f不是有效的方法类型"}this._bind_event(c,this._shape,d)};b.unEvent=function(c){this._unbind_event(c,this._shape)};b.setSize=function(c,d){this.Widget_setSize(c,d);this._shape.graphics.clear().beginFill(this.c).drawRect(this.x,this.y,this.w,this.h)};b.setPosition=function(d,c){this.Widget_setPosition(d,c);this._shape.graphics.clear().beginFill(this.c).drawRect(this.x,this.y,this.w,this.h)};b.getColor=function(){return this.c};b.setColor=function(c){this.c=c;this._shape.graphics.clear().beginFill(this.c).drawRect(this.x,this.y,this.w,this.h)};jeesjs.Panel=createjs.promote(a,"Widget")})();this.jeesjs=this.jeesjs||{};(function(){function a(d,c){this.Widget_constructor(c);this.t=d?d:"";this.f="12px Arial";this.c="#000000";this._text=new createjs.Text(this.t,this.f,this.c);this._text._drawText=this._draw_text;this._font_bold="";this._font_italic="";this._font_style="";this._font_size=12;this._font=" Arial";this._init_finish()}a.ALIGN_START="start";a.ALIGN_END="end";a.ALIGN_LEFT="left";a.ALIGN_RIGHT="right";a.ALIGN_CENTER="center";a.BASELINE_TOP="top";a.BASELINE_HANGING="hanging";a.BASELINE_MIDDLE="middle";a.BASELINE_ALPHABETIC="alphabetic";a.BASELINE_IDEOGRAPHIC="ideographic";a.BASELINE_BOTTOM="bottom";var b=createjs.extend(a,jeesjs.Widget);b.getWidget=function(){return this._text};b.getColor=function(){return this.c};b.setColor=function(c){this.c=c;this._text.color=this.c};b.getFontSize=function(){return this.f};b.setFont=function(c){this.f=c;this._text.font=this._get_font();this._set_size()};b.getFontSize=function(){return this._font_size};b.setFontSize=function(c){this._font_size=c;this._set_font();this._text.font=this._get_font();this._set_size()};b.getAlign=function(){return this._text.textAlign};b.setAlign=function(c){this._text.textAlign=c;this._set_size()};b.getBaseline=function(){return this._text.textBaseline};b.setBaseline=function(c){this._text.textBaseline=c;this._set_size()};b.getMaxWidth=function(){return this._text.maxWidth};b.setMaxWidth=function(c){this._text.maxWidth=c;this._set_size()};b.getLineWidth=function(){return this._text.lineWidth};b.setLineWidth=function(c){this._text.lineWidth=c;this._set_size()};b.getText=function(){return this.t};b.setText=function(c){this.t=c;this._text.text=this.t;this._set_size()};b.isBold=function(){return this._font_bold!=""};b.setBold=function(c){this._font_bold=c?" bold":"";this._set_font();this._text.font=this._get_font();this._set_size()};b.isItalic=function(){return this._font_bold!=""};b.setItalic=function(c){this._font_italic=c?" italic":"";this._set_font();this._text.font=this._get_font();this._set_size()};b._get_font=function(){return this.f};b._set_size=function(){var c=this._text.getBounds();this.w=c.width;this.h=c.height};b._set_font=function(){this.f=this._font_italic+this._font_bold+" "+this._font_size+"px "+this._font};b._draw_text=function(u,r,d){var q=!!u;if(!q){u=createjs.Text._workingContext;u.save();this._prepContext(u)}var f=this.lineHeight||this.getMeasuredLineHeight();var A=0,h=0;var e=String(this.text).split(/(?:\r\n|\r|\n)/);for(var y=0,v=e.length;y<v;y++){var s=e[y];var k=null;if(this.lineWidth!=null&&(k=u.measureText(s).width)>this.lineWidth){var p=s.split(/(\s|[\u4e00-\u9fa5]+)/);var t=[];for(var n=0;n<p.length;n++){var m=p[n];if(m==""){continue}if((/([\u4e00-\u9fa5]+)/).test(m)){t=t.concat(m.split(""))}else{t.push(m)}}p=t;s=p[0];k=u.measureText(s).width;for(var x=1,z=p.length;x<z;x+=2){var c=x+1<z?p[x+1]:"";var g=u.measureText(p[x]+c).width;if(k+g>this.lineWidth){if(p[x]!="s"){s+=p[x]}if(q){this._drawTextLine(u,s,h*f)}if(d){d.push(s)}if(k>A){A=k}s=c;k=u.measureText(s).width;h++}else{s+=p[x]+c;k+=g}}}if(q){this._drawTextLine(u,s,h*f)}if(d){d.push(s)}if(r&&k==null){k=u.measureText(s).width}if(k>A){A=k}h++}if(r){r.width=A;r.height=h*f}if(!q){u.restore()}return r};jeesjs.TextBox=createjs.promote(a,"Widget")})();